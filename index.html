<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…’ç«¥ç”Ÿé•·è©•ä¼°æ±ºç­–è¼”åŠ©ç³»çµ± - è•­å®‡è¶…é†«å¸«æ•´ç†</title>
    <style>
        body { font-family: "Microsoft JhengHei", "Heiti TC", sans-serif; background-color: #f0f2f5; padding: 20px; max-width: 900px; margin: 0 auto; color: #333; }
        
        .app-header { text-align: center; margin-bottom: 30px; }
        .app-title { font-size: 2em; color: #2c3e50; margin: 0; font-weight: bold; }
        .app-subtitle { color: #7f8c8d; font-size: 1.1em; margin-top: 8px; font-weight: 600; letter-spacing: 1px; }
        .app-version { font-size: 0.8em; color: #bdc3c7; margin-top: 5px; }

        .card { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 25px; border: 1px solid #e1e4e8; }
        h2 { color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 12px; margin-top: 0; font-size: 1.4em; }
        .section-title { font-weight: bold; color: #7f8c8d; margin-top: 20px; margin-bottom: 10px; text-transform: uppercase; font-size: 0.9em; letter-spacing: 1px; }
        
        label { display: block; margin-top: 15px; font-weight: 600; color: #2c3e50; font-size: 1.05em; }
        .sub-label { font-weight: normal; font-size: 0.9em; color: #666; margin-bottom: 5px; display: block; }
        
        input[type="number"], select { width: 100%; padding: 12px; margin-top: 5px; border: 2px solid #ecf0f1; border-radius: 8px; box-sizing: border-box; font-size: 16px; transition: border-color 0.3s; }
        input[type="number"]:focus, select:focus { border-color: #3498db; outline: none; }
        
        .radio-group { margin-top: 8px; display: flex; gap: 20px; }
        .radio-group label { display: flex; align-items: center; font-weight: normal; cursor: pointer; background: #f8f9fa; padding: 10px 20px; border-radius: 6px; border: 1px solid #dee2e6; }
        .radio-group input { margin-right: 8px; }
        
        .info-display { background-color: #e8f6f3; border: 1px solid #1abc9c; color: #16a085; padding: 15px; border-radius: 8px; margin-top: 15px; font-weight: bold; text-align: center; display: none; }
        .pah-result-box { background-color: #f3e5f5; border: 1px solid #9b59b6; color: #6a1b9a; padding: 15px; border-radius: 8px; margin-top: 10px; margin-bottom: 15px; text-align: center; display: none; }
        .bp-type-tag { font-size: 0.8em; background: #fff; padding: 2px 8px; border-radius: 4px; margin-left: 10px; border: 1px solid #ccc; }

        button { background-color: #2980b9; color: white; border: none; padding: 15px; border-radius: 8px; cursor: pointer; font-size: 18px; font-weight: bold; margin-top: 25px; width: 100%; transition: background 0.3s; box-shadow: 0 4px 6px rgba(41, 128, 185, 0.2); }
        button:hover { background-color: #1c6ea4; transform: translateY(-1px); }
        
        .calc-btn { background-color: #8e44ad; color: white; padding: 8px 15px; border-radius: 6px; font-size: 0.9em; border: none; cursor: pointer; margin-top: 10px; width: auto; display: inline-block; }
        .calc-btn:hover { background-color: #732d91; }

        #resultArea { display: none; animation: fadeIn 0.5s; }
        .recommendation-card { padding: 20px; border-radius: 8px; margin-top: 15px; border-left: 6px solid; background-color: #fff; }
        
        .workup-list { margin-top: 10px; padding-left: 20px; text-align: left; }
        .workup-list li { margin-bottom: 5px; }

        .alert-red { background-color: #fff5f5; border-color: #e53e3e; color: #c53030; }
        .alert-yellow { background-color: #fffff0; border-color: #d69e2e; color: #b7791f; }
        .alert-green { background-color: #f0fff4; border-color: #38a169; color: #2f855a; }
        .alert-blue { background-color: #ebf8ff; border-color: #3182ce; color: #2b6cb0; }
        .alert-gray { background-color: #f8f9fa; border-color: #95a5a6; color: #7f8c8d; }
        .alert-orange { background-color: #fff3e0; border-color: #e67e22; color: #d35400; }
        
        .highlight-box { background: rgba(0,0,0,0.03); padding: 10px; border-radius: 5px; margin-top: 10px; font-size: 0.95em; }
        .hidden { display: none; }
        .purple-label { color: #8e44ad; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="app-header">
        <h1 class="app-title">å…’ç«¥ç”Ÿé•·è©•ä¼°æ±ºç­–è¼”åŠ©ç³»çµ±</h1>
        <div class="app-subtitle">è•­å®‡è¶…é†«å¸« æ•´ç†</div>
        <div class="app-version">Ver 4.6 (Normal Puberty Logic Fixed)</div>
    </div>

    <div class="card">
        <h2>ğŸ¥ éšæ®µä¸€ï¼šåŸºç¤æ•¸æ“šè¼¸å…¥</h2>
        
        <div class="section-title">åŸºæœ¬è³‡æ–™</div>
        <label>æ€§åˆ¥</label>
        <select id="gender" onchange="calculateTH(); updateQuestions();">
            <option value="male">ç”·</option>
            <option value="female">å¥³</option>
        </select>

        <label>ç›®å‰èº«é«˜ (cm) <span style="color:red">*å¿…å¡« (ç”¨æ–¼è¨ˆç®— PAH)</span></label>
        <input type="number" id="currentHeight" placeholder="ä¾‹å¦‚: 135" oninput="calculateTH()">

        <label>å¯¦éš›å¹´é½¡ (æ­²)</label>
        <input type="number" id="age" placeholder="ä¾‹å¦‚: 10" oninput="updateQuestions()">

        <div class="section-title">éºå‚³è³‡è¨Š (è‡ªå‹•è¨ˆç®—)</div>
        <div style="display: flex; gap: 15px;">
            <div style="flex: 1;">
                <label style="margin-top:5px;">çˆ¶è¦ªèº«é«˜</label>
                <input type="number" id="fatherHt" placeholder="cm" oninput="calculateTH()">
            </div>
            <div style="flex: 1;">
                <label style="margin-top:5px;">æ¯è¦ªèº«é«˜</label>
                <input type="number" id="motherHt" placeholder="cm" oninput="calculateTH()">
            </div>
        </div>
        
        <div id="thDisplay" class="info-display"></div>

        <div class="section-title">ç”Ÿé•·æŒ‡æ¨™</div>
        <label>ç”Ÿé•·é€Ÿç‡ (GV, cm/å¹´)</label>
        <span class="sub-label">æ­£å¸¸ç¯„åœç´„ 4-6 cm/yr</span>
        <input type="number" id="gv" placeholder="éå»ä¸€å¹´é•·é«˜å¹¾å…¬åˆ†?" oninput="updateQuestions()">

        <label>BMI ç‹€æ…‹</label>
        <select id="bmiStatus">
            <option value="normal">æ­£å¸¸æˆ–éé‡</option>
            <option value="thin">éè¼• (BMI &lt; 3%)</option>
        </select>
        
        <div class="section-title">ç—…å²</div>
        <label>å‡ºç”Ÿæ˜¯å¦ç‚º SGA?</label>
        <div class="radio-group">
            <label><input type="radio" name="sga" value="yes"> æ˜¯</label>
            <label><input type="radio" name="sga" value="no" checked> å¦</label>
        </div>
    </div>

    <div class="card" id="dynamicQuestions">
        <h2>ğŸ©º éšæ®µäºŒï¼šé€²éšè©•ä¼° (è‡ªå‹•åµæ¸¬)</h2>
        
        <div id="q_puberty" class="hidden">
            <label style="color: #e67e22;">âš ï¸ æ€§å¾µæª¢æŸ¥</label>
            <span class="sub-label">æœ‰ææ—©ç™¼è‚²å¾µå…†? (å¥³&lt;8 B2 / ç”·&lt;9 G2)</span>
            <select id="pubertySign" onchange="updateDetailQuestions()">
                <option value="no">ç„¡</option>
                <option value="yes">æœ‰</option>
            </select>
            
            <div id="q_puberty_detail" class="hidden highlight-box">
                <label>é€²ç¨‹é€Ÿåº¦?</label>
                <select id="pubertyProgression">
                    <option value="unknown">å°šæœªè©•ä¼°</option>
                    <option value="slow">é€²ç¨‹æ…¢ / LH ä½</option>
                    <option value="fast">é€²ç¨‹å¿« / LH > 0.3</option>
                </select>
            </div>
        </div>

        <div id="q_boneage" class="hidden">
            <label style="color: #2980b9;">ğŸ¦´ éª¨é½¡åˆ¤è®€ & PAH è¨ˆç®—</label>
            <span class="sub-label">å»ºè­°æ‹æ”éª¨é½¡ï¼Œä»¥ç¢ºèªç”Ÿé•·æ½›åŠ› (PAH)ã€‚</span>
            
            <select id="boneAgeStatus" onchange="updatePAHQuestion()">
                <option value="unknown">å°šæœªæ‹æ”</option>
                <option value="match">éª¨é½¡ â‰ˆ å¹´é½¡ (ç›¸ç¬¦)</option>
                <option value="delay_mild">éª¨é½¡ < å¹´é½¡ (è½å¾Œ 1-2 å¹´)</option>
                <option value="delay_severe">éª¨é½¡ << å¹´é½¡ (åš´é‡è½å¾Œ > 2 å¹´)</option>
                <option value="advance">éª¨é½¡ > å¹´é½¡ (è¶…å‰)</option>
            </select>
            
            <div id="q_pah" class="hidden highlight-box">
                <label class="purple-label">ğŸŸ£ é ä¼°æˆäººèº«é«˜ (PAH) è¨ˆç®—æ©Ÿ</label>
                
                <div style="display: flex; gap: 10px; align-items: flex-end;">
                    <div style="flex: 1;">
                        <label style="margin-top:0;">éª¨é½¡ (Bone Age, æ­²)</label>
                        <input type="number" id="boneAgeValue" placeholder="ä¾‹å¦‚: 11">
                    </div>
                    <button type="button" class="calc-btn" onclick="calculateFullPAH()">è¨ˆç®— PAH</button>
                </div>

                <div id="pahResult" class="pah-result-box"></div>

                <label>PAH è©•ä¼°çµæœ (è‡ªå‹•å¡«å…¥)</label>
                <select id="pahStatus">
                    <option value="unknown">è«‹å…ˆé»æ“Šè¨ˆç®—</option>
                    <option value="good">PAH é”æ¨™ (åœ¨éºå‚³ç¯„åœå…§)</option>
                    <option value="poor">PAH å—æ (é¡¯è‘—ä½æ–¼éºå‚³èº«é«˜)</option>
                </select>
            </div>
        </div>
        
        <div id="q_turner" class="hidden">
            <label style="color: #8e44ad;">ğŸ§¬ ç‰¹ç´æ°ç—‡ç¯©æª¢</label>
            <select id="turnerCheck">
                <option value="no">å¦</option>
                <option value="yes">æ˜¯ (å»ºè­°ç¯©æª¢)</option>
            </select>
        </div>
    </div>

    <button onclick="analyze()">ğŸš€ é–‹å§‹åˆ†æèˆ‡ç”¢å‡ºå»ºè­°</button>

    <div id="resultArea"></div>

    <script>
        const bpFullData = {
            male: {
                average: { 6:64.9, 7:69.5, 8:73.9, 9:78.0, 10:81.3, 11:84.8, 11.5:86.6, 12:88.3, 12.5:90.3, 13:92.2, 13.5:94.2, 14:96.0, 14.5:97.2, 15:98.2, 15.5:98.9, 16:99.4, 17:99.8, 18:100 },
                accelerated: { 6:66.6, 7:71.3, 8:75.6, 9:79.5, 10:83.4, 11:86.7, 11.5:88.4, 12:90.0, 12.5:91.6, 13:93.4, 13.5:95.1, 14:96.6, 14.5:97.6, 15:98.5, 15.5:99.1, 16:99.6, 17:100 },
                retarded: { 6:63.2, 7:67.7, 8:71.9, 9:75.9, 10:79.4, 11:82.7, 11.5:84.6, 12:8
