<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…’ç«¥ç”Ÿé•·è©•ä¼°æ±ºç­–è¼”åŠ©ç³»çµ± - è•­å®‡è¶…é†«å¸«æ•´ç†</title>
    <style>
        body { font-family: "Microsoft JhengHei", "Heiti TC", sans-serif; background-color: #f0f2f5; padding: 20px; max-width: 900px; margin: 0 auto; color: #333; }
        
        .app-header { text-align: center; margin-bottom: 30px; }
        .app-title { font-size: 2em; color: #2c3e50; margin: 0; font-weight: bold; }
        .app-subtitle { color: #7f8c8d; font-size: 1.1em; margin-top: 8px; font-weight: 600; letter-spacing: 1px; }
        .app-version { font-size: 0.8em; color: #bdc3c7; margin-top: 5px; }

        .card { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 25px; border: 1px solid #e1e4e8; }
        h2 { color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 12px; margin-top: 0; font-size: 1.4em; }
        .section-title { font-weight: bold; color: #7f8c8d; margin-top: 20px; margin-bottom: 10px; text-transform: uppercase; font-size: 0.9em; letter-spacing: 1px; }
        
        label { display: block; margin-top: 15px; font-weight: 600; color: #2c3e50; font-size: 1.05em; }
        .sub-label { font-weight: normal; font-size: 0.9em; color: #666; margin-bottom: 5px; display: block; }
        
        input[type="number"], select { width: 100%; padding: 12px; margin-top: 5px; border: 2px solid #ecf0f1; border-radius: 8px; box-sizing: border-box; font-size: 16px; transition: border-color 0.3s; }
        input[type="number"]:focus, select:focus { border-color: #3498db; outline: none; }
        
        .radio-group { margin-top: 8px; display: flex; gap: 20px; }
        .radio-group label { display: flex; align-items: center; font-weight: normal; cursor: pointer; background: #f8f9fa; padding: 10px 20px; border-radius: 6px; border: 1px solid #dee2e6; }
        .radio-group input { margin-right: 8px; }
        
        .info-display {
            background-color: #e8f6f3;
            border: 1px solid #1abc9c;
            color: #16a085;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-weight: bold;
            text-align: center;
            display: none;
        }
        .pah-result-box {
            background-color: #f3e5f5;
            border: 1px solid #9b59b6;
            color: #6a1b9a;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            margin-bottom: 15px;
            text-align: center;
            display: none;
        }
        .bp-type-tag { font-size: 0.8em; background: #fff; padding: 2px 8px; border-radius: 4px; margin-left: 10px; border: 1px solid #ccc; }

        button { background-color: #2980b9; color: white; border: none; padding: 15px; border-radius: 8px; cursor: pointer; font-size: 18px; font-weight: bold; margin-top: 25px; width: 100%; transition: background 0.3s; box-shadow: 0 4px 6px rgba(41, 128, 185, 0.2); }
        button:hover { background-color: #1c6ea4; transform: translateY(-1px); }
        
        .calc-btn {
            background-color: #8e44ad;
            color: white;
            padding: 8px 15px;
            border-radius: 6px;
            font-size: 0.9em;
            border: none;
            cursor: pointer;
            margin-top: 10px;
            width: auto;
            display: inline-block;
        }
        .calc-btn:hover { background-color: #732d91; }

        #resultArea { display: none; animation: fadeIn 0.5s; }
        .recommendation-card { padding: 20px; border-radius: 8px; margin-top: 15px; border-left: 6px solid; background-color: #fff; }
        
        .alert-red { background-color: #fff5f5; border-color: #e53e3e; color: #c53030; }
        .alert-yellow { background-color: #fffff0; border-color: #d69e2e; color: #b7791f; }
        .alert-green { background-color: #f0fff4; border-color: #38a169; color: #2f855a; }
        .alert-blue { background-color: #ebf8ff; border-color: #3182ce; color: #2b6cb0; }
        .alert-gray { background-color: #f8f9fa; border-color: #95a5a6; color: #7f8c8d; }
        .alert-orange { background-color: #fff3e0; border-color: #e67e22; color: #d35400; }
        
        .highlight-box { background: rgba(0,0,0,0.03); padding: 10px; border-radius: 5px; margin-top: 10px; font-size: 0.95em; }
        .hidden { display: none; }
        .purple-label { color: #8e44ad; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="app-header">
        <h1 class="app-title">å…’ç«¥ç”Ÿé•·è©•ä¼°æ±ºç­–è¼”åŠ©ç³»çµ±</h1>
        <div class="app-subtitle">è•­å®‡è¶…é†«å¸« æ•´ç†</div>
        <div class="app-version">Ver 4.4 (Pubertal Potential Check)</div>
    </div>

    <div class="card">
        <h2>ğŸ¥ éšæ®µä¸€ï¼šåŸºç¤æ•¸æ“šè¼¸å…¥</h2>
        
        <div class="section-title">åŸºæœ¬è³‡æ–™</div>
        <label>æ€§åˆ¥</label>
        <select id="gender" onchange="calculateTH(); updateQuestions();">
            <option value="male">ç”·</option>
            <option value="female">å¥³</option>
        </select>

        <label>ç›®å‰èº«é«˜ (cm) <span style="color:red">*å¿…å¡« (ç”¨æ–¼è¨ˆç®— PAH)</span></label>
        <input type="number" id="currentHeight" placeholder="ä¾‹å¦‚: 145" oninput="calculateTH()">

        <label>å¯¦éš›å¹´é½¡ (æ­²)</label>
        <input type="number" id="age" placeholder="ä¾‹å¦‚: 12" oninput="updateQuestions()">

        <div class="section-title">éºå‚³è³‡è¨Š (è‡ªå‹•è¨ˆç®—)</div>
        <div style="display: flex; gap: 15px;">
            <div style="flex: 1;">
                <label style="margin-top:5px;">çˆ¶è¦ªèº«é«˜</label>
                <input type="number" id="fatherHt" placeholder="cm" oninput="calculateTH()">
            </div>
            <div style="flex: 1;">
                <label style="margin-top:5px;">æ¯è¦ªèº«é«˜</label>
                <input type="number" id="motherHt" placeholder="cm" oninput="calculateTH()">
            </div>
        </div>
        
        <div id="thDisplay" class="info-display"></div>

        <div class="section-title">ç”Ÿé•·æŒ‡æ¨™</div>
        <label>ç”Ÿé•·é€Ÿç‡ (GV, cm/å¹´)</label>
        <span class="sub-label">æ­£å¸¸ç¯„åœç´„ 4-6 cm/yr</span>
        <input type="number" id="gv" placeholder="éå»ä¸€å¹´é•·é«˜å¹¾å…¬åˆ†?" oninput="updateQuestions()">

        <label>BMI ç‹€æ…‹</label>
        <select id="bmiStatus">
            <option value="normal">æ­£å¸¸æˆ–éé‡</option>
            <option value="thin">éè¼• (BMI &lt; 3%)</option>
        </select>
        
        <div class="section-title">ç—…å²</div>
        <label>å‡ºç”Ÿæ˜¯å¦ç‚º SGA?</label>
        <div class="radio-group">
            <label><input type="radio" name="sga" value="yes"> æ˜¯</label>
            <label><input type="radio" name="sga" value="no" checked> å¦</label>
        </div>
    </div>

    <div class="card" id="dynamicQuestions">
        <h2>ğŸ©º éšæ®µäºŒï¼šé€²éšè©•ä¼° (è‡ªå‹•åµæ¸¬)</h2>
        
        <div id="q_puberty" class="hidden">
            <label style="color: #e67e22;">âš ï¸ æ€§å¾µæª¢æŸ¥</label>
            <span class="sub-label">æœ‰ææ—©ç™¼è‚²å¾µå…†? (å¥³&lt;8 B2 / ç”·&lt;9 G2)</span>
            <select id="pubertySign" onchange="updateDetailQuestions()">
                <option value="no">ç„¡</option>
                <option value="yes">æœ‰</option>
            </select>
            
            <div id="q_puberty_detail" class="hidden highlight-box">
                <label>é€²ç¨‹é€Ÿåº¦?</label>
                <select id="pubertyProgression">
                    <option value="unknown">å°šæœªè©•ä¼°</option>
                    <option value="slow">é€²ç¨‹æ…¢ / LH ä½</option>
                    <option value="fast">é€²ç¨‹å¿« / LH > 0.3</option>
                </select>
            </div>
        </div>

        <div id="q_boneage" class="hidden">
            <label style="color: #2980b9;">ğŸ¦´ éª¨é½¡åˆ¤è®€ & PAH è¨ˆç®—</label>
            <span class="sub-label">è‹¥å®¶é•·æ“”å¿ƒæœ€çµ‚èº«é«˜ä¸å¤ ï¼Œè«‹æ‹æ”éª¨é½¡ä¸¦è¼¸å…¥æ•¸å€¼é€²è¡Œé ä¼°ã€‚</span>
            
            <select id="boneAgeStatus" onchange="updatePAHQuestion()">
                <option value="unknown">å°šæœªæ‹æ”</option>
                <option value="match">éª¨é½¡ â‰ˆ å¹´é½¡ (ç›¸ç¬¦)</option>
                <option value="delay_mild">éª¨é½¡ < å¹´é½¡ (è½å¾Œ 1-2 å¹´)</option>
                <option value="delay_severe">éª¨é½¡ << å¹´é½¡ (åš´é‡è½å¾Œ > 2 å¹´)</option>
                <option value="advance">éª¨é½¡ > å¹´é½¡ (è¶…å‰)</option>
            </select>
            
            <div id="q_pah" class="hidden highlight-box">
                <label class="purple-label">ğŸŸ£ é ä¼°æˆäººèº«é«˜ (PAH) è¨ˆç®—æ©Ÿ</label>
                
                <div style="display: flex; gap: 10px; align-items: flex-end;">
                    <div style="flex: 1;">
                        <label style="margin-top:0;">éª¨é½¡ (Bone Age, æ­²)</label>
                        <input type="number" id="boneAgeValue" placeholder="ä¾‹å¦‚: 13.5">
                    </div>
                    <button type="button" class="calc-btn" onclick="calculateFullPAH()">è¨ˆç®— PAH</button>
                </div>

                <div id="pahResult" class="pah-result-box"></div>

                <label>PAH è©•ä¼°çµæœ (è‡ªå‹•å¡«å…¥)</label>
                <select id="pahStatus">
                    <option value="unknown">è«‹å…ˆé»æ“Šè¨ˆç®—</option>
                    <option value="good">PAH é”æ¨™ (åœ¨éºå‚³ç¯„åœå…§)</option>
                    <option value="poor">PAH å—æ (é¡¯è‘—ä½æ–¼éºå‚³èº«é«˜)</option>
                </select>
            </div>
        </div>
        
        <div id="q_turner" class="hidden">
            <label style="color: #8e44ad;">ğŸ§¬ ç‰¹ç´æ°ç—‡ç¯©æª¢</label>
            <select id="turnerCheck">
                <option value="no">å¦</option>
                <option value="yes">æ˜¯ (å»ºè­°ç¯©æª¢)</option>
            </select>
        </div>

    </div>

    <button onclick="analyze()">ğŸš€ é–‹å§‹åˆ†æèˆ‡ç”¢å‡ºå»ºè­°</button>

    <div id="resultArea"></div>

    <script>
        // Bayley-Pinneau Data
        const bpFullData = {
            male: {
                average: { 6:64.9, 7:69.5, 8:73.9, 9:78.0, 10:81.3, 11:84.8, 11.5:86.6, 12:88.3, 12.5:90.3, 13:92.2, 13.5:94.2, 14:96.0, 14.5:97.2, 15:98.2, 15.5:98.9, 16:99.4, 17:99.8, 18:100 },
                accelerated: { 6:66.6, 7:71.3, 8:75.6, 9:79.5, 10:83.4, 11:86.7, 11.5:88.4, 12:90.0, 12.5:91.6, 13:93.4, 13.5:95.1, 14:96.6, 14.5:97.6, 15:98.5, 15.5:99.1, 16:99.6, 17:100 },
                retarded: { 6:63.2, 7:67.7, 8:71.9, 9:75.9, 10:79.4, 11:82.7, 11.5:84.6, 12:86.5, 12.5:88.5, 13:90.7, 13.5:92.9, 14:95.0, 14.5:96.5, 15:97.7, 15.5:98.5, 16:99.1, 17:99.7, 18:100 }
            },
            female: {
                average: { 6:69.5, 7:73.7, 8:77.8, 9:81.7, 10:85.3, 10.5:87.2, 11:89.2, 11.5:91.3, 12:93.3, 12.5:95.1, 13:96.6, 13.5:97.7, 14:98.5, 15:99.5, 16:100 },
                accelerated: { 6:71.2, 7:75.3, 8:79.5, 9:83.2, 10:86.8, 10.5:88.6, 11:90.5, 11.5:92.3, 12:94.2, 12.5:95.8, 13:97.1, 13.5:98.1, 14:98.9, 15:99.7, 16:100 },
                retarded: { 6:67.8, 7:72.1, 8:76.1, 9:80.0, 10:83.6, 10.5:85.5, 11:87.6, 11.5:89.8, 12:91.9, 12.5:94.1, 13:95.9, 13.5:97.3, 14:98.2, 15:99.3, 16:99.8 }
            }
        };

        function calculateTH() {
            const gender = document.getElementById('gender').value;
            const father = parseFloat(document.getElementById('fatherHt').value);
            const mother = parseFloat(document.getElementById('motherHt').value);
            const displayDiv = document.getElementById('thDisplay');

            if (father && mother) {
                let midParentalHeight = (gender === 'male') ? (father + mother + 12) / 2 : (father + mother - 12) / 2;
                const lower = (midParentalHeight - 7.5).toFixed(1);
                const upper = (midParentalHeight + 7.5).toFixed(1);
                displayDiv.dataset.midTh = midParentalHeight;
                displayDiv.style.display = 'block';
                displayDiv.innerHTML = `ğŸ§¬ éºå‚³ç›®æ¨™èº«é«˜ (Target Height): <br><span style="font-size:1.2em">${midParentalHeight.toFixed(1)} cm</span> <br><span style="font-size:0.8em; font-weight:normal">(å€é–“: ${lower} ~ ${upper} cm)</span>`;
            } else {
                displayDiv.style.display = 'none';
                displayDiv.dataset.midTh = "";
            }
        }

        function calculateFullPAH() {
            const gender = document.getElementById('gender').value;
            const age = parseFloat(document.getElementById('age').value);
            const currentHt = parseFloat(document.getElementById('currentHeight').value);
            const boneAge = parseFloat(document.getElementById('boneAgeValue').value);
            const resultBox = document.getElementById('pahResult');
            const statusSelect = document.getElementById('pahStatus');
            const thDisplay = document.getElementById('thDisplay');

            if (!currentHt || !boneAge || !age) {
                alert("è«‹è¼¸å…¥å®Œæ•´è³‡æ–™ï¼");
                return;
            }

            let diff = boneAge - age;
            let category = 'average';
            let catText = 'ç›¸ç¬¦å‹ (Average)';
            if (diff >= 1) { category = 'accelerated'; catText = 'å¿«é€²å‹ (Accelerated)'; } 
            else if (diff <= -1) { category = 'retarded'; catText = 'é²ç·©å‹ (Retarded)'; }

            let table = bpFullData[gender][category];
            let percent = 0;
            
            let closestBA = Object.keys(table).reduce((prev, curr) => {
                return (Math.abs(curr - boneAge) < Math.abs(prev - boneAge) ? curr : prev);
            });
            percent = table[closestBA];

            if (!percent) {
                resultBox.style.display = 'block';
                resultBox.innerHTML = "éª¨é½¡è¶…å‡ºè¨ˆç®—ç¯„åœï¼Œç„¡æ³•é ä¼°ã€‚";
                return;
            }

            let pah = currentHt / (percent / 100);
            
            let thMsg = "";
            let midTh = parseFloat(thDisplay.dataset.midTh);
            if (midTh) {
                let gap = pah - midTh;
                let threshold = (gender === 'male') ? 7.5 : 5.5;
                if (gap < -threshold) {
                    statusSelect.value = "poor";
                    thMsg = `<br><span style='color:#c0392b'>ğŸ“‰ ä½æ–¼éºå‚³ç›®æ¨™ (å·®è· > ${threshold}cm)</span>`;
                } else {
                    statusSelect.value = "good";
                    thMsg = "<br><span style='color:#27ae60'>âœ… ç¬¦åˆéºå‚³é æœŸ</span>";
                }
            }

            resultBox.style.display = 'block';
            resultBox.innerHTML = `
                <div style="margin-bottom:5px;">
                    <span style="font-size:0.9em; color:#555;">ä½¿ç”¨è¡¨æ ¼: </span>
                    <span class="bp-type-tag">${catText}</span>
                </div>
                ğŸ¦´ éª¨é½¡ ${closestBA} æ­²æ™‚ï¼Œé”æˆç‡ç´„ ${percent}%<br>
                <strong>ğŸŸ£ é ä¼°èº«é«˜ (PAH): ${pah.toFixed(1)} cm</strong>
                ${thMsg}
            `;
        }

        function updateQuestions() {
            const gender = document.getElementById('gender').value;
            const age = parseFloat(document.getElementById('age').value);
            const gv = parseFloat(document.getElementById('gv').value);

            document.getElementById('q_puberty').classList.add('hidden');
            document.getElementById('q_boneage').classList.add('hidden');
            document.getElementById('q_turner').classList.add('hidden');
            document.getElementById('q_pah').classList.add('hidden'); 

            if (!age) return;

            // æ€§æ—©ç†Ÿç¯©æª¢
            if ((gender === 'female' && age < 8) || (gender === 'male' && age < 9)) {
                document.getElementById('q_puberty').classList.remove('hidden');
            }

            if (!gv && gv !== 0) return;

            // 1. æ­£å¸¸ GV (4-6) -> é¡¯ç¤ºéª¨é½¡
            if (gv >= 4 && gv <= 6) {
                document.getElementById('q_boneage').classList.remove('hidden');
                if (gender === 'female') {
                    document.getElementById('q_turner').classList.remove('hidden');
                }
            }
            
            // 2. å¿« GV (>6)
            if (gv > 6) {
                // å¦‚æœæ˜¯æ­£å¸¸é’æ˜¥æœŸå¹´é½¡ï¼Œé›–ç„¶ GV å¿«æ˜¯æ­£å¸¸çš„ï¼Œä½†å®¶é•·å¯èƒ½æ“”å¿ƒ PAH
                // æ‰€ä»¥é€™è£¡ä¹Ÿé–‹æ”¾éª¨é½¡é¸é …ï¼Œè®“é†«å¸«æ±ºå®šæ˜¯å¦è¦ç®—
                 if ((gender === 'female' && age >= 8) || (gender === 'male' && age >= 9)) {
                     document.getElementById('q_boneage').classList.remove('hidden');
                 }
            }
            
            const pubSign = document.getElementById('pubertySign').value;
            if (pubSign === 'yes') {
                 document.getElementById('q_boneage').classList.remove('hidden');
            }
        }

        function updateDetailQuestions() {
            const sign = document.getElementById('pubertySign').value;
            const detailDiv = document.getElementById('q_puberty_detail');
            const boneAgeDiv = document.getElementById('q_boneage');
            
            if (sign === 'yes') {
                detailDiv.classList.remove('hidden');
                boneAgeDiv.classList.remove('hidden'); 
            } else {
                detailDiv.classList.add('hidden');
            }
        }

        function updatePAHQuestion() {
            const baStatus = document.getElementById('boneAgeStatus').value;
            if (baStatus !== 'unknown') {
                document.getElementById('q_pah').classList.remove('hidden');
            } else {
                document.getElementById('q_pah').classList.add('hidden');
            }
        }

        function analyze() {
            const gender = document.getElementById('gender').value;
            const age = parseFloat(document.getElementById('age').value);
            const gv = parseFloat(document.getElementById('gv').value);
            const bmiStatus = document.getElementById('bmiStatus').value;
            const sga = document.querySelector('input[name="sga"]:checked').value;
            
            const pubertySign = document.getElementById('pubertySign').value;
            const pubertyProgression = document.getElementById('pubertyProgression').value;
            const boneAgeStatus = document.getElementById('boneAgeStatus').value;
            const pahStatus = document.getElementById('pahStatus').value;
            const turnerCheck = document.getElementById('turnerCheck').value;

            if (!age || (gv !== 0 && !gv)) {
                alert("è«‹å…ˆè¼¸å…¥å¹´é½¡èˆ‡ç”Ÿé•·é€Ÿç‡ï¼");
                return;
            }

            let html = "";
            let title = "";
            let colorClass = "";

            let isGrowthClosing = false;
            if (gv < 4) {
                if (gender === 'female' && age >= 14) isGrowthClosing = true;
                if (gender === 'male' && age >= 16) isGrowthClosing = true;
            }

            // åˆ¤æ–·æ˜¯å¦ç‚ºæ­£å¸¸é’æ˜¥æœŸè¡åˆº
            let isNormalPubertySpurt = false;
            if (gv > 6) {
                if ((gender === 'female' && age >= 8) || (gender === 'male' && age >= 9)) {
                    isNormalPubertySpurt = true;
                }
            }

            if (isGrowthClosing) {
                title = "ğŸŸ¢ ç”Ÿé•·è¶¨ç·©/é–‰åˆæœŸ (æ­£å¸¸ç¾è±¡)";
                colorClass = "alert-gray";
                html = `<strong>åˆ¤æ–·ï¼š</strong>é’æ˜¥æœŸå°¾è²ï¼Œç”Ÿé•·æ¿æ¥è¿‘é–‰åˆï¼ŒGV ä¸‹é™ç‚ºæ­£å¸¸ç”Ÿç†ç¾è±¡ã€‚<br><strong>å»ºè­°ï¼š</strong>ä¸éœ€è½‰ä»‹ã€‚å¯æ‹æ”éª¨é½¡ç¢ºèªé–‰åˆç¨‹åº¦ã€‚`;
            }
            else if (sga === 'yes' && gv < 4 && age > 4) {
                 title = "ğŸ”´ å»ºè­°è½‰ä»‹ (SGA é©æ‡‰ç—‡)";
                 colorClass = "alert-red";
                 html = `<strong>åˆ¤æ–·ï¼š</strong>SGA ä¸”æœªè¿½è¶•ç”Ÿé•·ï¼Œç¬¦åˆç”Ÿé•·æ¿€ç´ æ²»ç™‚é©æ‡‰ç—‡ã€‚<br><strong>è¡Œå‹•ï¼š</strong>è½‰ä»‹å…’ç§‘å…§åˆ†æ³Œã€‚`;
            }
            else if ( ((gender === 'female' && age < 8) || (gender === 'male' && age < 9)) && pubertySign === 'yes' ) {
                if (pubertyProgression === 'fast' || boneAgeStatus === 'advance') {
                    if (pahStatus === 'poor') {
                        title = "ğŸ”´ å¼·çƒˆå»ºè­°è½‰ä»‹ (æ€§æ—©ç†Ÿä¸” PAH å—æ)";
                        colorClass = "alert-red";
                        html = `<strong>åˆ¤æ–·ï¼š</strong>ç–‘ä¼¼ä¸­æ¨æ€§æ€§æ—©ç†Ÿ (CPP) ä¸” PAH åš´é‡å—æã€‚<br><strong>è¡Œå‹•ï¼š</strong>éœ€è½‰ä»‹è©•ä¼° GnRHa æ²»ç™‚ã€‚`;
                    } else if (pahStatus === 'good') {
                        title = "ğŸŸ¡ è½‰ä»‹è©•ä¼° / å¯†åˆ‡è§€å¯Ÿ (PAH å°šå¯)";
                        colorClass = "alert-yellow";
                        html = `<strong>åˆ¤æ–·ï¼š</strong>é›–æœ‰æ—©ç†Ÿè·¡è±¡ï¼Œä½† PAH ä»åœ¨éºå‚³ç¯„åœå…§ã€‚å¯è¨è«–æ˜¯å¦åƒ…éœ€è§€å¯Ÿã€‚`;
                    } else {
                         title = "ğŸ”´ å»ºè­°è½‰ä»‹ (ç–‘ä¼¼æ€§æ—©ç†Ÿ CPP)";
                         colorClass = "alert-red";
                         html = `<strong>åˆ¤æ–·ï¼š</strong>æ€§å¾µæ˜é¡¯ä¸”é€²ç¨‹å¿«ã€‚è«‹è½‰ä»‹å°ˆç§‘ã€‚`;
                    }
                } else {
                     title = "ğŸŸ¢ è‰¯æ€§è®Šç•° (å–®ç´”æ—©ç†Ÿ)";
                     colorClass = "alert-green";
                     html = `<strong>åˆ¤æ–·ï¼š</strong>æ€§å¾µé€²ç¨‹ç·©æ…¢ï¼Œéª¨é½¡æœªè¶…å‰ã€‚å®šæœŸè¿½è¹¤å³å¯ã€‚`;
                }
            }
            else if (isNormalPubertySpurt) {
                // ç‰¹æ®Šåˆ¤æ–·ï¼šå¦‚æœæ˜¯æ­£å¸¸è¡åˆºï¼Œä½† PAH é¡¯ç¤ºå—æ
                if (pahStatus === 'poor') {
                    title = "ğŸŸ  è­¦ç¤ºï¼šé’æ˜¥æœŸè¡åˆºä½†é ä¼°èº«é«˜å—æ";
                    colorClass = "alert-orange";
                    html = `
                        <strong>åˆ¤æ–·ï¼š</strong>ç›®å‰ç”Ÿé•·é€Ÿåº¦æ­£å¸¸(é’æ˜¥æœŸè¡åˆº)ï¼Œä½†<strong>éª¨é½¡è€åŒ–éå¿«</strong>ï¼Œå°è‡´é ä¼°èº«é«˜ (PAH) ä½æ–¼éºå‚³ç›®æ¨™ã€‚<br>
                        <strong>å»ºè­°è¡Œå‹•ï¼š</strong>
                        1. è½‰ä»‹å…’ç§‘å…§åˆ†æ³Œç§‘ï¼Œè¨è«–æ˜¯å¦æœ‰å»¶ç·©éª¨é½¡çš„ç©ºé–“ã€‚<br>
                        2. åš´æ ¼åŸ·è¡Œç”Ÿæ´»ä½œæ¯èª¿æ•´ (ç¡çœ /é£²é£Ÿ/é‹å‹•) ä»¥æœ€å¤§åŒ–å‰©é¤˜æ½›åŠ›ã€‚
                    `;
                } else {
                    title = "ğŸŸ¢ æ­£å¸¸çš„é’æ˜¥æœŸç”Ÿé•·è¡åˆº (Pubertal Spurt)";
                    colorClass = "alert-green";
                    html = `<strong>åˆ¤æ–·ï¼š</strong>å¹´é½¡ç¬¦åˆé’æ˜¥æœŸï¼Œå‡ºç¾ç”Ÿé•·åŠ é€Ÿç‚ºæ­£å¸¸ç”Ÿç†ç¾è±¡ã€‚<br><strong>å»ºè­°ï¼š</strong>è§€å¯Ÿå³å¯ã€‚ç›®å‰ PAH é ä¼°è½é»è‰¯å¥½ã€‚`;
                }
            }
            else if (gv > 6) {
                title = "ğŸŸ¢ è§€å¯Ÿå³å¯ (å–®ç´”é«˜å¤§)";
                colorClass = "alert-green";
                html = `<strong>åˆ¤æ–·ï¼š</strong>ç”Ÿé•·å¿«é€Ÿä½†ç„¡æ€§å¾µï¼Œå¯èƒ½ç‚ºéºå‚³é«˜å¤§æˆ–é«”è³ªæ€§å¿«é•·ã€‚`;
            }
            else if (gv < 4) {
                 if (bmiStatus === 'thin') {
                    title = "ğŸ”´ å»ºè­°è½‰ä»‹ (è…¸èƒƒ/ä»£è¬)";
                    colorClass = "alert-red";
                    html = `<strong>æ‡·ç–‘ï¼š</strong>ç‡Ÿé¤Šä¸è‰¯ã€ä»£è¬æ€§éª¨ç—…ã€‚<br><strong>å¿…é©—ï¼š</strong>CBC, Ferritin, tTG-IgA, <strong>Ca, P, ALK-P</strong>ã€‚`;
                 } else {
                    title = "ğŸ”´ å»ºè­°è½‰ä»‹ (å…§åˆ†æ³Œ)";
                    colorClass = "alert-red";
                    html = `<strong>æ‡·ç–‘ï¼š</strong>GHDã€ç”²ç‹€è…ºã€Turnerã€‚<br><strong>å¿…é©—ï¼š</strong>éª¨é½¡, IGF-1, TSH, T4, Ca/P/ALK-Pã€‚`;
                 }
            }
            else {
                if (boneAgeStatus === 'delay_severe') {
                    title = "âš ï¸ è­¦ç¤ºï¼šéœ€æ’é™¤éš±è—ç—…ç†";
                    colorClass = "alert-yellow";
                    html = `<strong>é¢¨éšªï¼š</strong>GV æ­£å¸¸ä½†éª¨é½¡åš´é‡è½å¾Œ (>2å¹´)ã€‚éœ€æ’é™¤ç”²ç‹€è…ºæˆ–ä¹³ç³œç€‰ã€‚`;
                } else if (gender === 'female' && turnerCheck === 'yes') {
                    title = "âš ï¸ è­¦ç¤ºï¼šéœ€æ’é™¤ç‰¹ç´æ°ç—‡";
                    colorClass = "alert-yellow";
                    html = `<strong>å»ºè­°ï¼š</strong>ä¸æ˜åŸå› çŸ®å°å¥³æ€§ï¼Œè«‹é©—æŸ“è‰²é«”ã€‚`;
                } else if (boneAgeStatus === 'delay_mild') {
                    if (pahStatus === 'good') {
                        title = "ğŸ”µ é«”è³ªæ€§ç”Ÿé•·é²ç·© (CDGP) - ğŸŸ¢ é å¾Œä½³";
                        colorClass = "alert-blue";
                        html = `<strong>å®‰æ’«å®¶é•·ï¼š</strong>éª¨é½¡è½å¾Œä½† PAH é¡¯ç¤ºæœªä¾†æœƒè¿½ä¸Šéºå‚³èº«é«˜ (æ™šé•·)ã€‚`;
                    } else if (pahStatus === 'poor') {
                         title = "âš ï¸ è­¦ç¤ºï¼šé«”è³ªæ€§é²ç·©ä½†é å¾Œä¸ä½³";
                         colorClass = "alert-yellow";
                         html = `<strong>åˆ¤æ–·ï¼š</strong>é›–ä¼¼ CDGPï¼Œä½† PAH åä½ã€‚å»ºè­°æª¢æŸ¥æ˜¯å¦åˆä½µå…¶ä»–å•é¡Œã€‚`;
                    } else {
                         title = "ğŸ”µ é«”è³ªæ€§ç”Ÿé•·é²ç·© (CDGP)";
                         colorClass = "alert-blue";
                         html = `<strong>åˆ¤æ–·ï¼š</strong>éª¨é½¡è½å¾Œï¼Œå±¬æ–¼æ™šç™¼è‚²é«”è³ªã€‚`;
                    }
                } else if (boneAgeStatus === 'match') {
                    title = "ğŸ”µ å®¶æ—æ€§çŸ®å° (FSS)";
                    colorClass = "alert-blue";
                    html = `<strong>åˆ¤æ–·ï¼š</strong>éª¨é½¡ç›¸ç¬¦ã€‚ä¾å¾ªçˆ¶æ¯éºå‚³è»Œè·¡ç”Ÿé•·ã€‚`;
                } else {
                    title = "ğŸ”µ æ­£å¸¸ç”Ÿé•·ç›£æ¸¬";
                    colorClass = "alert-blue";
                    html = `<strong>å»ºè­°ï¼š</strong>æ•¸æ“šæ­£å¸¸ã€‚å»ºè­°æ‹æ”éª¨é½¡ä»¥å€åˆ† FSS æˆ– CDGPã€‚`;
                }
            }

            const resultDiv = document.getElementById('resultArea');
            resultDiv.innerHTML = `
                <div class="recommendation-card ${colorClass}">
                    <h3 style="margin-top:0;">${title}</h3>
                    <div style="line-height: 1.6;">${html}</div>
                </div>
            `;
            resultDiv.style.display = 'block';
            resultDiv.scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>
